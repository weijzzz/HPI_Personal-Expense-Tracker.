import sys

def show_menu():
    """Displays the main menu to the user."""
    print("\n--- Simple Expense Tracker ---")
    print("1. Add a new expense")
    print("2. View all expenses and total")
    print("3. View summary by category")
    print("4. Exit")
    choice = input("Enter your choice (1-4): ")
    return choice

def add_expense(expenses_list):
    """
    Prompts the user for expense details and adds it to the list.
    The expense is stored as a dictionary.
    """
    print("\nAdding a new expense...")
    description = input("Enter description (e.g., 'Coffee'): ")
    
    # Loop until a valid amount is entered
    while True:
        try:
            # Get amount and convert to float
            amount = float(input("Enter amount: "))
            # Format to 2 decimal places
            amount = round(amount, 2)
            break # Exit loop if conversion is successful
        except ValueError:
            print("Invalid input. Please enter a number (e.g., 12.50)")
            
    category = input("Enter category (e.g., 'Food', 'Transport', 'Fun'): ")
    
    # Create the dictionary for the new expense
    expense = {
        "description": description,
        "amount": amount,
        "category": category
    }
    
    # Add the new dictionary to our main list
    expenses_list.append(expense)
    print(f"Success: Added '{description}' (${amount:.2f}) to '{category}'.")

def view_expenses(expenses_list):
    """
    Displays all recorded expenses and calculates the grand total.
    """
    print("\n--- All Expenses ---")
    
    if not expenses_list:
        print("No expenses recorded yet.")
        return

    total_spending = 0
    # Use enumerate to get an index (like 1., 2., 3.)
    for i, expense in enumerate(expenses_list):
        desc = expense["description"]
        amt = expense["amount"]
        cat = expense["category"]
        
        # f-string formatting: :<20 aligns left, :>10 aligns right
        print(f"{i+1}. {desc:<20} | {cat:<15} | ${amt:>10.2f}")
        total_spending += amt
        
    print("-" * 50) # Prints a horizontal line
    print(f"TOTAL SPENDING:                ${total_spending:>10.2f}")

def view_summary(expenses_list):
    """
    Calculates and displays the total spending for each category.
    """
    print("\n--- Summary by Category ---")
    
    if not expenses_list:
        print("No expenses recorded yet.")
        return

    # Use a dictionary to store category totals
    category_totals = {}
    
    # Loop through all expenses
    for expense in expenses_list:
        category = expense["category"]
        amount = expense["amount"]
        
        # If the category is already in our summary, add to it.
        # Otherwise, create it with the current amount.
        # dict.get(key, 0) is a safe way to get a value,
        # defaulting to 0 if the key doesn't exist yet.
        category_totals[category] = category_totals.get(category, 0) + amount

    # Print the summary
    if not category_totals:
        print("No categories found.")
        return
        
    for category, total in category_totals.items():
        # :<15 aligns category left, :>10.2f aligns amount right
        print(f"{category:<15} | ${total:>10.2f}")

def main():
    """Main function to run the application."""
    
    # This list will hold all our expense dictionaries
    expenses = []

    # Main application loop
    while True:
        choice = show_menu()
        
        if choice == '1':
            add_expense(expenses)
        elif choice == '2':
            view_expenses(expenses)
        elif choice == '3':
            view_summary(expenses)
        elif choice == '4':
            print("Exiting. Goodbye!")
            sys.exit() # Cleanly exits the program
        else:
            print("Invalid choice. Please enter a number between 1 and 4.")

# Standard Python entry point
if __name__ == "__main__":
    main()w
